Loading data...
3928 train sequences
437 validation sequences
486 evaluation sequences
embedding_lmdb_path is not specified in the embeddings registry, so the embeddings will be loaded in memory...
loading embeddings...
path: /lustre/group/tdm/Luca/delft/delft/data/embeddings/glove.840B.300d.txt
embeddings loaded for 2196017 words and 300 dimensions
Output directory: data/models/sequenceLabelling/values-BidLSTM_CRF_FEATURES
---
max_epoch: 60
early_stop: True
batch_size: 20
max_sequence_length: 3000
model_name: values-BidLSTM_CRF_FEATURES
learning_rate:  0.001
use_ELMo:  False
---
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 features_input (InputLayer)    [(None, None, 3)]    0           []                               
                                                                                                  
 char_input (InputLayer)        [(None, None, 30)]   0           []                               
                                                                                                  
 features_embedding_td (TimeDis  (None, None, 3, 4)  148         ['features_input[0][0]']         
 tributed)                                                                                        
                                                                                                  
 time_distributed (TimeDistribu  (None, None, 30, 25  1675       ['char_input[0][0]']             
 ted)                           )                                                                 
                                                                                                  
 features_embedding_td_2 (TimeD  (None, None, 8)     288         ['features_embedding_td[0][0]']  
 istributed)                                                                                      
                                                                                                  
 word_input (InputLayer)        [(None, None, 300)]  0           []                               
                                                                                                  
 time_distributed_1 (TimeDistri  (None, None, 50)    10200       ['time_distributed[0][0]']       
 buted)                                                                                           
                                                                                                  
 dropout (Dropout)              (None, None, 8)      0           ['features_embedding_td_2[0][0]']
                                                                                                  
 concatenate (Concatenate)      (None, None, 358)    0           ['word_input[0][0]',             
                                                                  'time_distributed_1[0][0]',     
                                                                  'dropout[0][0]']                
                                                                                                  
 dropout_1 (Dropout)            (None, None, 358)    0           ['concatenate[0][0]']            
                                                                                                  
 bidirectional_2 (Bidirectional  (None, None, 200)   367200      ['dropout_1[0][0]']              
 )                                                                                                
                                                                                                  
 dropout_2 (Dropout)            (None, None, 200)    0           ['bidirectional_2[0][0]']        
                                                                                                  
 length_input (InputLayer)      [(None, 1)]          0           []                               
                                                                                                  
 dense (Dense)                  (None, None, 100)    20100       ['dropout_2[0][0]']              
                                                                                                  
==================================================================================================
Total params: 399,611
Trainable params: 399,611
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "crf_model_wrapper_default"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 crf (CRF)                   multiple                  1380      
                                                                 
 model (Functional)          (None, None, 100)         399611    
                                                                 
=================================================================
Total params: 400,991
Trainable params: 400,991
Non-trainable params: 0
_________________________________________________________________

[...]

training runtime: 5066.758 seconds 

Evaluation:
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 features_input (InputLayer)    [(None, None, 3)]    0           []                               
                                                                                                  
 char_input (InputLayer)        [(None, None, 30)]   0           []                               
                                                                                                  
 features_embedding_td (TimeDis  (None, None, 3, 4)  148         ['features_input[0][0]']         
 tributed)                                                                                        
                                                                                                  
 time_distributed (TimeDistribu  (None, None, 30, 25  1675       ['char_input[0][0]']             
 ted)                           )                                                                 
                                                                                                  
 features_embedding_td_2 (TimeD  (None, None, 8)     288         ['features_embedding_td[0][0]']  
 istributed)                                                                                      
                                                                                                  
 word_input (InputLayer)        [(None, None, 300)]  0           []                               
                                                                                                  
 time_distributed_1 (TimeDistri  (None, None, 50)    10200       ['time_distributed[0][0]']       
 buted)                                                                                           
                                                                                                  
 dropout (Dropout)              (None, None, 8)      0           ['features_embedding_td_2[0][0]']
                                                                                                  
 concatenate (Concatenate)      (None, None, 358)    0           ['word_input[0][0]',             
                                                                  'time_distributed_1[0][0]',     
                                                                  'dropout[0][0]']                
                                                                                                  
 dropout_1 (Dropout)            (None, None, 358)    0           ['concatenate[0][0]']            
                                                                                                  
 bidirectional_2 (Bidirectional  (None, None, 200)   367200      ['dropout_1[0][0]']              
 )                                                                                                
                                                                                                  
 dropout_2 (Dropout)            (None, None, 200)    0           ['bidirectional_2[0][0]']        
                                                                                                  
 length_input (InputLayer)      [(None, 1)]          0           []                               
                                                                                                  
 dense (Dense)                  (None, None, 100)    20100       ['dropout_2[0][0]']              
                                                                                                  
==================================================================================================
Total params: 399,611
Trainable params: 399,611
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "crf_model_wrapper_default"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 crf (CRF)                   multiple                  1380      
                                                                 
 model (Functional)          (None, None, 100)         399611    
                                                                 
=================================================================
Total params: 400,991
Trainable params: 400,991
Non-trainable params: 0
_________________________________________________________________
---
max_epoch: 60
early_stop: True
batch_size: 20
max_sequence_length: 3000
model_name: values-BidLSTM_CRF_FEATURES
learning_rate:  0.001
use_ELMo:  False
---

------------------------ fold 0 --------------------------------------
	f1 (micro): 99.19
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9926    0.9950       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.8889    1.0000    0.9412        16

all (micro avg.)     0.9919    0.9919    0.9919       494


------------------------ fold 1 --------------------------------------
	f1 (micro): 99.19
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9926    0.9950       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.8889    1.0000    0.9412        16

all (micro avg.)     0.9919    0.9919    0.9919       494


------------------------ fold 2 --------------------------------------
	f1 (micro): 98.38
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9925    0.9851    0.9888       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.7619    1.0000    0.8649        16

all (micro avg.)     0.9819    0.9858    0.9838       494


------------------------ fold 3 --------------------------------------
	f1 (micro): 98.38
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9826    0.9900       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.7273    1.0000    0.8421        16

all (micro avg.)     0.9838    0.9838    0.9838       494


------------------------ fold 4 --------------------------------------
	f1 (micro): 98.08
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9950    0.9801    0.9875       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.6957    1.0000    0.8205        16

all (micro avg.)     0.9798    0.9818    0.9808       494


------------------------ fold 5 --------------------------------------
	f1 (micro): 97.98
                  precision    recall  f1-score   support

         <alpha>     0.9701    0.9701    0.9701        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9851    0.9913       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.6957    1.0000    0.8205        16

all (micro avg.)     0.9778    0.9818    0.9798       494


------------------------ fold 6 --------------------------------------
	f1 (micro): 98.89
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9950    0.9901    0.9925       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.8421    1.0000    0.9143        16

all (micro avg.)     0.9879    0.9899    0.9889       494


------------------------ fold 7 --------------------------------------
	f1 (micro): 98.48
                  precision    recall  f1-score   support

         <alpha>     0.9851    0.9851    0.9851        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9876    0.9925       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.7619    1.0000    0.8649        16

all (micro avg.)     0.9838    0.9858    0.9848       494


------------------------ fold 8 --------------------------------------
	f1 (micro): 98.99
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9901    0.9938       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.8421    1.0000    0.9143        16

all (micro avg.)     0.9899    0.9899    0.9899       494


------------------------ fold 9 --------------------------------------
	f1 (micro): 98.28
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9950    0.9826    0.9888       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.7273    1.0000    0.8421        16

all (micro avg.)     0.9818    0.9838    0.9828       494

----------------------------------------------------------------------

** Worst ** model scores - run 5
                  precision    recall  f1-score   support

         <alpha>     0.9701    0.9701    0.9701        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9851    0.9913       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.6957    1.0000    0.8205        16

all (micro avg.)     0.9778    0.9818    0.9798       494


** Best ** model scores - run 0
                  precision    recall  f1-score   support

         <alpha>     1.0000    1.0000    1.0000        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9975    0.9926    0.9950       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.8889    1.0000    0.9412        16

all (micro avg.)     0.9919    0.9919    0.9919       494

----------------------------------------------------------------------

Average over 10 folds
                  precision    recall  f1-score   support

         <alpha>     0.9955    0.9955    0.9955        67
          <base>     1.0000    1.0000    1.0000         4
        <number>     0.9962    0.9868    0.9915       403
           <pow>     0.7500    0.7500    0.7500         4
          <time>     0.7832    1.0000    0.8766        16

all (micro avg.)     0.9851    0.9866    0.9858          

model config file saved
preprocessor saved
model saved
